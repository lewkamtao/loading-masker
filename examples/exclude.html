<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Masker - æ’é™¤èŠ‚ç‚¹ç¤ºä¾‹</title>
    <style>
        body {
            font-family: system-ui, sans-serif;
            max-width: 1000px;
            margin: 40px auto;
            padding: 20px;
        }

        .container {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            min-height: 300px;
            position: relative;
            background: #fafafa;
            margin: 20px 0;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            background: #007bff;
            color: white;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }

        button:hover {
            background: #0056b3;
        }

        .item {
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 4px;
            border-left: 3px solid #007bff;
        }

        .ad-banner {
            padding: 20px;
            margin: 10px 0;
            background: #ffebee;
            border: 2px dashed #f44336;
            border-radius: 4px;
            color: #c62828;
            text-align: center;
            font-weight: bold;
        }

        .sidebar {
            padding: 15px;
            margin: 10px 0;
            background: #e3f2fd;
            border: 2px dashed #2196f3;
            border-radius: 4px;
            color: #1565c0;
        }

        .info {
            background: #f0f8ff;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 20px 0;
        }

        .stats {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
        }
    </style>
</head>

<body>
    <h1>Masker - æ’é™¤èŠ‚ç‚¹ç¤ºä¾‹</h1>

    <div class="info">
        <strong>åŠŸèƒ½è¯´æ˜ï¼š</strong><br>
        - <code>excludeSelectors</code> é…ç½®å¯ä»¥æŒ‡å®šå“ªäº›èŠ‚ç‚¹ä¸è®¡å…¥æ·±åº¦å’Œæ•°é‡ç»Ÿè®¡<br>
        - æ”¯æŒ classï¼ˆ<code>.xxx</code>ï¼‰ã€idï¼ˆ<code>#xxx</code>ï¼‰ç­‰æ‰€æœ‰ CSS é€‰æ‹©å™¨<br>
        - è¢«æ’é™¤çš„èŠ‚ç‚¹åŠå…¶æ‰€æœ‰å­èŠ‚ç‚¹éƒ½ä¸ä¼šè¢«è®¡å…¥ç»Ÿè®¡<br>
        - Loading è¦†ç›–å±‚æœ¬èº«ä¼šè¢«è‡ªåŠ¨æ’é™¤
    </div>

    <section>
        <h2>ç¤ºä¾‹å¯¹æ¯”ï¼šæ’é™¤ vs ä¸æ’é™¤</h2>

        <h3>åœºæ™¯ 1ï¼šä¸æ’é™¤å¹¿å‘Šå’Œä¾§è¾¹æ </h3>
        <p>å½“èŠ‚ç‚¹æ•°è¾¾åˆ° 5 ä¸ªæ—¶å…³é—­ï¼ˆåŒ…å«å¹¿å‘Šå’Œä¾§è¾¹æ ï¼‰</p>
        <button onclick="demo1()">å¼€å§‹ - ä¸æ’é™¤</button>
        <button onclick="reset1()">é‡ç½®</button>
        <div id="stats1" class="stats"></div>
        <div id="container1" class="container"></div>

        <h3>åœºæ™¯ 2ï¼šæ’é™¤å¹¿å‘Šå’Œä¾§è¾¹æ </h3>
        <p>å½“èŠ‚ç‚¹æ•°è¾¾åˆ° 5 ä¸ªæ—¶å…³é—­ï¼ˆæ’é™¤å¹¿å‘Šå’Œä¾§è¾¹æ ï¼Œåªç»Ÿè®¡çœŸå®å†…å®¹ï¼‰</p>
        <button onclick="demo2()">å¼€å§‹ - æ’é™¤å¹¿å‘Šå’Œä¾§è¾¹æ </button>
        <button onclick="reset2()">é‡ç½®</button>
        <div id="stats2" class="stats"></div>
        <div id="container2" class="container"></div>
    </section>

    <script type="module">
        import { createMasker } from '../dist/index.mjs'

        let masker1, masker2

        function updateStats(containerId, statsId, currentCount) {
            document.getElementById(statsId).textContent =
                `å½“å‰ç»Ÿè®¡èŠ‚ç‚¹æ•°: ${currentCount} / 5`
        }

        // ç¤ºä¾‹ 1: ä¸æ’é™¤
        window.demo1 = function () {
            reset1()
            const container = document.getElementById('container1')

            masker1 = createMasker({
                node: container,
                minNodes: 5,  // èŠ‚ç‚¹æ•°è¾¾åˆ° 5 æ—¶å…³é—­
                maxDuration: 25000,
                throttleDelay: 100,
            })

            masker1.show()

            let count = 0

            // æ·»åŠ å¹¿å‘Šï¼ˆä¼šè¢«è®¡å…¥ç»Ÿè®¡ï¼‰
            setTimeout(() => {
                const ad = document.createElement('div')
                ad.className = 'ad-banner'
                ad.textContent = 'ğŸ¯ å¹¿å‘Šæ¨ªå¹…ï¼ˆä¼šè¢«è®¡å…¥ç»Ÿè®¡ï¼‰'
                container.appendChild(ad)
                count++
                updateStats('container1', 'stats1', count)
            }, 500)

            // æ·»åŠ ä¾§è¾¹æ ï¼ˆä¼šè¢«è®¡å…¥ç»Ÿè®¡ï¼‰
            setTimeout(() => {
                const sidebar = document.createElement('div')
                sidebar.className = 'sidebar'
                sidebar.id = 'sidebar'
                sidebar.textContent = 'ğŸ“‹ ä¾§è¾¹æ ï¼ˆä¼šè¢«è®¡å…¥ç»Ÿè®¡ï¼‰'
                container.appendChild(sidebar)
                count++
                updateStats('container1', 'stats1', count)
            }, 1000)

            // æ·»åŠ çœŸå®å†…å®¹
            for (let i = 1; i <= 3; i++) {
                setTimeout(() => {
                    const item = document.createElement('div')
                    item.className = 'item'
                    item.textContent = `å†…å®¹å— ${i}`
                    container.appendChild(item)
                    count++
                    updateStats('container1', 'stats1', count)
                }, 1000 + i * 500)
            }
        }

        window.reset1 = function () {
            if (masker1) masker1.destroy()
            document.getElementById('container1').innerHTML = ''
            document.getElementById('stats1').textContent = ''
        }

        // ç¤ºä¾‹ 2: æ’é™¤å¹¿å‘Šå’Œä¾§è¾¹æ 
        window.demo2 = function () {
            reset2()
            const container = document.getElementById('container2')

            masker2 = createMasker({
                node: container,
                minNodes: 5,  // èŠ‚ç‚¹æ•°è¾¾åˆ° 5 æ—¶å…³é—­
                excludeSelectors: ['.ad-banner', '#sidebar'],  // æ’é™¤è¿™äº›èŠ‚ç‚¹
                throttleDelay: 100,
            })

            masker2.show()

            let count = 1  // å®¹å™¨æœ¬èº«

            // æ·»åŠ å¹¿å‘Šï¼ˆä¸ä¼šè¢«è®¡å…¥ç»Ÿè®¡ï¼‰
            setTimeout(() => {
                const ad = document.createElement('div')
                ad.className = 'ad-banner'
                ad.textContent = 'ğŸ¯ å¹¿å‘Šæ¨ªå¹…ï¼ˆå·²æ’é™¤ï¼Œä¸è®¡å…¥ç»Ÿè®¡ï¼‰'
                container.appendChild(ad)
                updateStats('container2', 'stats2', count)
            }, 500)

            // æ·»åŠ ä¾§è¾¹æ ï¼ˆä¸ä¼šè¢«è®¡å…¥ç»Ÿè®¡ï¼‰
            setTimeout(() => {
                const sidebar = document.createElement('div')
                sidebar.className = 'sidebar'
                sidebar.id = 'sidebar'
                sidebar.textContent = 'ğŸ“‹ ä¾§è¾¹æ ï¼ˆå·²æ’é™¤ï¼Œä¸è®¡å…¥ç»Ÿè®¡ï¼‰'
                container.appendChild(sidebar)
                updateStats('container2', 'stats2', count)
            }, 1000)

            // æ·»åŠ çœŸå®å†…å®¹ï¼ˆä¼šè¢«è®¡å…¥ç»Ÿè®¡ï¼‰
            for (let i = 1; i <= 5; i++) {
                setTimeout(() => {
                    const item = document.createElement('div')
                    item.className = 'item'
                    item.textContent = `å†…å®¹å— ${i}`
                    container.appendChild(item)
                    count++
                    updateStats('container2', 'stats2', count)
                }, 1000 + i * 500)
            }
        }

        window.reset2 = function () {
            if (masker2) masker2.destroy()
            document.getElementById('container2').innerHTML = ''
            document.getElementById('stats2').textContent = ''
        }
    </script>
</body>

</html>