<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Masker - åŸºç¡€ç¤ºä¾‹</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .demo-container {
      border: 2px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
      min-height: 200px;
      position: relative;
    }

    .controls {
      margin: 20px 0;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    button {
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      background: #007bff;
      color: white;
      cursor: pointer;
      font-size: 14px;
    }

    button:hover {
      background: #0056b3;
    }

    .info {
      background: #f0f8ff;
      border-left: 4px solid #007bff;
      padding: 15px;
      margin: 20px 0;
    }

    .item {
      padding: 10px;
      margin: 5px 0;
      background: #f5f5f5;
      border-radius: 4px;
    }

    .warning {
      background: #fff3cd;
      color: #856404;
    }
  </style>
</head>
<body>
  <h1>Masker - åŸºç¡€ç¤ºä¾‹</h1>

  <div class="info">
    <strong>æç¤ºï¼š</strong>ç‚¹å‡»æŒ‰é’®è§¦å‘ä¸åŒçš„åœºæ™¯ï¼Œè§‚å¯Ÿ Loading å¦‚ä½•æ ¹æ®æ¡ä»¶è‡ªåŠ¨å…³é—­ã€‚
  </div>

  <!-- ç¤ºä¾‹ 1: åŸºäºèŠ‚ç‚¹æ•°é‡ -->
  <section>
    <h2>ç¤ºä¾‹ 1: åŸºäºèŠ‚ç‚¹æ•°é‡</h2>
    <p>å½“å®¹å™¨å†…çš„å­èŠ‚ç‚¹è¾¾åˆ° 10 ä¸ªæ—¶è‡ªåŠ¨å…³é—­ Loading</p>
    <div class="controls">
      <button onclick="startDemo1()">å¼€å§‹åŠ è½½</button>
      <button onclick="resetDemo1()">é‡ç½®</button>
    </div>
    <div id="demo1" class="demo-container"></div>
  </section>

  <!-- ç¤ºä¾‹ 2: åŸºäºé€‰æ‹©å™¨ -->
  <section>
    <h2>ç¤ºä¾‹ 2: åŸºäºé€‰æ‹©å™¨</h2>
    <p>å½“ .header å’Œ .content å…ƒç´ éƒ½å‡ºç°æ—¶è‡ªåŠ¨å…³é—­ Loading</p>
    <div class="controls">
      <button onclick="startDemo2()">å¼€å§‹åŠ è½½</button>
      <button onclick="resetDemo2()">é‡ç½®</button>
    </div>
    <div id="demo2" class="demo-container"></div>
  </section>

  <!-- ç¤ºä¾‹ 3: åŸºäºæ·±åº¦æ£€æµ‹ -->
  <section>
    <h2>ç¤ºä¾‹ 3: åŸºäºæ·±åº¦æ£€æµ‹</h2>
    <p>å½“ DOM æ ‘æ·±åº¦è¾¾åˆ° 3 å±‚æ—¶è‡ªåŠ¨å…³é—­ Loading</p>
    <div class="controls">
      <button onclick="startDemo3()">å¼€å§‹åŠ è½½</button>
      <button onclick="resetDemo3()">é‡ç½®</button>
    </div>
    <div id="demo3" class="demo-container"></div>
  </section>

  <!-- ç¤ºä¾‹ 4: è¶…æ—¶å…œåº• -->
  <section>
    <h2>ç¤ºä¾‹ 4: è¶…æ—¶å…œåº•</h2>
    <p>è®¾ç½® 3 ç§’è¶…æ—¶ï¼Œå³ä½¿æ¡ä»¶ä¸æ»¡è¶³ä¹Ÿä¼šå¼ºåˆ¶å…³é—­</p>
    <div class="controls">
      <button onclick="startDemo4()">å¼€å§‹åŠ è½½</button>
      <button onclick="resetDemo4()">é‡ç½®</button>
    </div>
    <div id="demo4" class="demo-container"></div>
  </section>

  <script type="module">
    // å¼•å…¥çœŸå®çš„ masker åº“
    import { createMasker } from '../dist/index.mjs'

    let masker1, masker2, masker3, masker4

    // ç¤ºä¾‹ 1: åŸºäºèŠ‚ç‚¹æ•°é‡
    window.startDemo1 = function() {
      resetDemo1()
      const container = document.getElementById('demo1')
      
      masker1 = createMasker({
        node: container,
        minNodes: 10,  // èŠ‚ç‚¹æ•°è¾¾åˆ° 10 æ—¶è‡ªåŠ¨å…³é—­
      })
      
      masker1.show()

      // æ¨¡æ‹Ÿé€æ­¥æ·»åŠ èŠ‚ç‚¹
      let count = 0
      const interval = setInterval(() => {
        if (count >= 10) {
          clearInterval(interval)
          return
        }
        const item = document.createElement('div')
        item.className = 'item'
        item.textContent = `èŠ‚ç‚¹ ${count + 1}`
        container.appendChild(item)
        count++
      }, 300)
    }

    window.resetDemo1 = function() {
      if (masker1) masker1.destroy()
      document.getElementById('demo1').innerHTML = ''
    }

    // ç¤ºä¾‹ 2: åŸºäºé€‰æ‹©å™¨
    window.startDemo2 = function() {
      resetDemo2()
      const container = document.getElementById('demo2')
      
      masker2 = createMasker({
        node: container,
        requiredSelectors: ['.header', '.content'],  // å¿…é¡»å­˜åœ¨çš„é€‰æ‹©å™¨
      })
      
      masker2.show()

      // å…ˆæ·»åŠ  header
      setTimeout(() => {
        const header = document.createElement('div')
        header.className = 'item header'
        header.textContent = 'âœ… Header å·²åŠ è½½'
        container.appendChild(header)
      }, 500)

      // å†æ·»åŠ  content (æ­¤æ—¶è‡ªåŠ¨å…³é—­)
      setTimeout(() => {
        const content = document.createElement('div')
        content.className = 'item content'
        content.textContent = 'âœ… Content å·²åŠ è½½'
        container.appendChild(content)
      }, 1500)
    }

    window.resetDemo2 = function() {
      if (masker2) masker2.destroy()
      document.getElementById('demo2').innerHTML = ''
    }

    // ç¤ºä¾‹ 3: åŸºäºæ·±åº¦æ£€æµ‹
    window.startDemo3 = function() {
      resetDemo3()
      const container = document.getElementById('demo3')
      
      masker3 = createMasker({
        node: container,
        maxDepth: 3,  // æ·±åº¦è¾¾åˆ° 3 å±‚æ—¶è‡ªåŠ¨å…³é—­
      })
      
      masker3.show()

      // é€å±‚æ„å»ºåµŒå¥—ç»“æ„
      // å±‚çº§ 1
      setTimeout(() => {
        const level1 = document.createElement('div')
        level1.className = 'item'
        level1.textContent = 'ğŸ“¦ ç¬¬ 1 å±‚'
        container.appendChild(level1)
        
        // å±‚çº§ 2
        setTimeout(() => {
          const level2 = document.createElement('div')
          level2.className = 'item'
          level2.style.marginLeft = '20px'
          level2.textContent = 'ğŸ“¦ ç¬¬ 2 å±‚'
          level1.appendChild(level2)
          
          // å±‚çº§ 3 (æ­¤æ—¶æ·±åº¦è¾¾åˆ° 3ï¼Œè‡ªåŠ¨å…³é—­)
          setTimeout(() => {
            const level3 = document.createElement('div')
            level3.className = 'item'
            level3.style.marginLeft = '20px'
            level3.textContent = 'ğŸ“¦ ç¬¬ 3 å±‚ (æ·±åº¦è¾¾åˆ°ï¼Œè‡ªåŠ¨å…³é—­ï¼)'
            level2.appendChild(level3)
          }, 500)
        }, 500)
      }, 500)
    }

    window.resetDemo3 = function() {
      if (masker3) masker3.destroy()
      document.getElementById('demo3').innerHTML = ''
    }

    // ç¤ºä¾‹ 4: è¶…æ—¶å…œåº•
    window.startDemo4 = function() {
      resetDemo4()
      const container = document.getElementById('demo4')
      
      masker4 = createMasker({
        node: container,
        minNodes: 999999,  // æ°¸è¿œä¸ä¼šæ»¡è¶³çš„æ¡ä»¶
        maxDuration: 3000, // 3 ç§’åå¼ºåˆ¶å…³é—­
        onTimeout: () => {
          const msg = document.createElement('div')
          msg.className = 'item warning'
          msg.textContent = 'âš ï¸ è¶…æ—¶å…œåº•ï¼šå·²å¼ºåˆ¶å…³é—­ Loading'
          container.appendChild(msg)
        }
      })
      
      masker4.show()
    }

    window.resetDemo4 = function() {
      if (masker4) masker4.destroy()
      document.getElementById('demo4').innerHTML = ''
    }
  </script>
</body>
</html>

