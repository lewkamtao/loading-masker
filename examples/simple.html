<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Masker - ç®€å•ç¤ºä¾‹</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      max-width: 800px;
      margin: 40px auto;
      padding: 20px;
    }

    .container {
      border: 2px solid #ddd;
      border-radius: 8px;
      padding: 40px;
      min-height: 300px;
      position: relative;
      background: #fafafa;
    }

    button {
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      background: #007bff;
      color: white;
      cursor: pointer;
      font-size: 16px;
      margin: 10px 5px;
    }

    button:hover {
      background: #0056b3;
    }

    .item {
      padding: 12px;
      margin: 8px 0;
      background: white;
      border-radius: 4px;
      border-left: 3px solid #007bff;
    }
  </style>
</head>
<body>
  <h1>Masker - ç®€å•ç¤ºä¾‹</h1>
  <p>ç‚¹å‡»æŒ‰é’®æŸ¥çœ‹ä¸åŒçš„ Loading æ•ˆæœ</p>

  <div>
    <button onclick="demo1()">ç¤ºä¾‹ 1: èŠ‚ç‚¹æ•°é‡è§¦å‘</button>
    <button onclick="demo2()">ç¤ºä¾‹ 2: æ·±åº¦æ£€æµ‹</button>
    <button onclick="demo3()">ç¤ºä¾‹ 3: è¶…æ—¶å…œåº•</button>
    <button onclick="demo4()">ç¤ºä¾‹ 4: è‡ªå®šä¹‰ UI</button>
    <button onclick="reset()">é‡ç½®</button>
  </div>

  <div id="container" class="container"></div>

  <script type="module">
    import { createMasker } from '../dist/index.mjs'

    let currentMasker = null

    window.reset = function() {
      if (currentMasker) {
        currentMasker.destroy()
        currentMasker = null
      }
      document.getElementById('container').innerHTML = ''
    }

    window.demo1 = function() {
      reset()
      const container = document.getElementById('container')

      currentMasker = createMasker({
        node: container,
        minNodes: 5,  // 5 ä¸ªèŠ‚ç‚¹æ—¶è‡ªåŠ¨å…³é—­
      })

      currentMasker.show()

      // é€æ­¥æ·»åŠ å†…å®¹
      let count = 0
      const interval = setInterval(() => {
        if (count >= 5) {
          clearInterval(interval)
          return
        }
        const item = document.createElement('div')
        item.className = 'item'
        item.textContent = `å†…å®¹å— ${count + 1}`
        container.appendChild(item)
        count++
      }, 500)
    }

    window.demo2 = function() {
      reset()
      const container = document.getElementById('container')

      currentMasker = createMasker({
        node: container,
        maxDepth: 4,  // æ·±åº¦è¾¾åˆ° 4 å±‚æ—¶è‡ªåŠ¨å…³é—­
      })

      currentMasker.show()

      // æ„å»ºåµŒå¥—ç»“æ„
      let current = container
      for (let i = 1; i <= 4; i++) {
        setTimeout(() => {
          const div = document.createElement('div')
          div.className = 'item'
          div.style.marginLeft = (i - 1) * 15 + 'px'
          div.textContent = `ç¬¬ ${i} å±‚${i === 4 ? ' âœ“ æ·±åº¦è¾¾åˆ°ï¼Œè‡ªåŠ¨å…³é—­ï¼' : ''}`
          current.appendChild(div)
          current = div
        }, i * 400)
      }
    }

    window.demo3 = function() {
      reset()
      const container = document.getElementById('container')

      currentMasker = createMasker({
        node: container,
        maxDuration: 2000,  // 2 ç§’åå¼ºåˆ¶å…³é—­
        onTimeout: () => {
          container.innerHTML = '<div class="item" style="border-left-color: #ffc107;">âš ï¸ åŠ è½½è¶…æ—¶ï¼ˆ2ç§’å…œåº•ï¼‰</div>'
        }
      })

      currentMasker.show()
    }

    window.demo4 = function() {
      reset()
      const container = document.getElementById('container')

      currentMasker = createMasker({
        node: container,
        maxDuration: 3000,
        renderLoading: () => {
          const div = document.createElement('div')
          div.style.cssText = `
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 24px;
            font-weight: bold;
          `
          div.innerHTML = `
            <div style="margin-bottom: 20px;">ğŸ¨</div>
            <div>è‡ªå®šä¹‰åŠ è½½ä¸­...</div>
          `
          return div
        }
      })

      currentMasker.show()
    }
  </script>
</body>
</html>

